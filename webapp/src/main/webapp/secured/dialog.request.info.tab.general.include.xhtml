<?xml version="1.0" encoding="UTF-8" ?>
<ui:composition xmlns="http://www.w3.org/1999/xhtml"
	xmlns:h="http://xmlns.jcp.org/jsf/html"
	xmlns:ui="http://xmlns.jcp.org/jsf/facelets"
	xmlns:c="http://xmlns.jcp.org/jsp/jstl/core"
	xmlns:p="http://primefaces.org/ui"
	xmlns:pe="http://primefaces.org/ui/extensions"
	xmlns:jfc="http://lapsa.tech/javax/faces-commons"
	xmlns:crm="http://xmlns.jcp.org/jsf/composite/crm">

	<p:tab title="Общие сведения" rendered="#{rendered}">

		<p:panel>
			<p:panelGrid>

				<crm:outputRow label="Номер">
					<p:inputText readonly="true" value="#{rr.id}"
						onfocus="this.select()" size="10" />
					<p:button id="idCopy" icon="fa fa-fw fa-copy" href="#"
						title="Скопирвать в буфер обмена" />
					<pe:clipboard trigger="idCopy" action="copy" text="#{rr.id}" />
				</crm:outputRow>

				<crm:outputRowText label="Тип заявки"
					value="#{localized.few(rr.insuranceRequestType)}" />

				<crm:outputRowText label="Стадия обработки заявки"
					value="#{localized.few(rr.progressStatus)}" />

				<crm:outputRow rendered="#{rr.progressStatus eq 'FINISHED'}"
					label="Статус договора">
					<c:choose>
						<c:when test="#{rr.insuranceRequestStatus eq 'CANCELED'}">
							<h:panelGroup styleClass="request-icon icon-fail ">
								<i class="fa fa-ban " aria-hidden="true" />
							</h:panelGroup>
						</c:when>
						<c:when test="#{rr.insuranceRequestStatus eq 'COMPLETED'}">
							<h:panelGroup styleClass="request-icon icon-success ">
								<i class="fa fa-check " aria-hidden="true" />
							</h:panelGroup>
						</c:when>
					</c:choose>
					<h:outputText value="#{localized.few(rr.insuranceRequestStatus)}" />
				</crm:outputRow>

				<crm:outputRowText
					rendered="#{rr.progressStatus eq 'FINISHED' and rr.insuranceRequestStatus eq 'CANCELED'}"
					label="Причина отмены заявки" value="#{localized.few(rr.insuranceRequestCancellationReason)}" />

				<crm:outputRowText
					rendered="#{rr.progressStatus eq 'FINISHED' and rr.insuranceRequestStatus eq 'COMPLETED'}"
					label="Номер договора" value="#{rr.agreementNumber}" />

			</p:panelGrid>
		</p:panel>

		<p:panel>

			<p:panelGrid>
				<p:row>

					<p:column>
						<p:panelGrid>

							<crm:outputRow label="Заявка поступила">
								<jfc:outputInstant value="#{rr.created}" />
								<h:outputText rendered="#{not empty rr.createdBy}"
									value="&amp;nbsp;(#{rr.createdBy.name})" escape="false" />
							</crm:outputRow>

							<crm:outputRow label="Обновлена">
								<jfc:outputInstant value="#{rr.updated}" />
							</crm:outputRow>

						</p:panelGrid>
					</p:column>

					<p:column>
						<p:panelGrid>

							<crm:outputRow rendered="#{not empty rr.picked}"
								label="Принята в обработку">
								<jfc:outputInstant value="#{rr.picked}" />
								<h:outputText rendered="#{not empty rr.pickedBy}"
									value="&amp;nbsp;(#{rr.pickedBy.name})" escape="false" />
							</crm:outputRow>

							<crm:outputRow rendered="#{not empty rr.completed}"
								label="Обработка завершена">
								<jfc:outputInstant value="#{rr.completed}" />
								<h:outputText rendered="#{not empty rr.completedBy}"
									value="&amp;nbsp;(#{rr.completedBy.name})" escape="false" />
							</crm:outputRow>

						</p:panelGrid>
					</p:column>

				</p:row>
			</p:panelGrid>

		</p:panel>

		<p:panel>
			<p:panelGrid>
				<crm:outputRow label="Комментарии">
					<p:inputTextarea value="#{rr.note}" placeholder="Нет комментариев"
						style="border: none" readonly="true" cols="70" rows="7"
						autoResize="false" disabled="true" />
				</crm:outputRow>
			</p:panelGrid>
		</p:panel>

	</p:tab>

</ui:composition>
