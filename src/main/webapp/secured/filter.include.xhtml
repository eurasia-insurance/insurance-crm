<?xml version="1.0" encoding="UTF-8" ?>
<ui:composition xmlns="http://www.w3.org/1999/xhtml"
	xmlns:h="http://xmlns.jcp.org/jsf/html"
	xmlns:f="http://xmlns.jcp.org/jsf/core"
	xmlns:ui="http://xmlns.jcp.org/jsf/facelets"
	xmlns:p="http://primefaces.org/ui">

	<f:subview>

		<!-- >> wrapper -->
		<h:panelGroup id="content">

			<p:panelGrid>
				<p:row>
					<p:column>

						<p:panelGrid>
							<p:row>
								<p:column>
									<p:commandLink process="@this" update="@form" value="Открытые"
										action="#{mainFacade.doRefresh}"
										style="#{settings.requestFilter.requestStatus == 'OPEN' ? 'font-weight: bold' : ''}">
										<f:setPropertyActionListener
											target="#{settings.requestFilter.requestStatus}" value="OPEN" />
									</p:commandLink>
								</p:column>
								<p:column>
									<p:commandLink process="@this" update="@form" value="Закрытые"
										action="#{mainFacade.doRefresh}"
										style="#{settings.requestFilter.requestStatus == 'CLOSED' ? 'font-weight: bold' : ''}">
										<f:setPropertyActionListener
											target="#{settings.requestFilter.requestStatus}"
											value="CLOSED" />
									</p:commandLink>
								</p:column>
								<p:column>
									<p:commandLink process="@this" update="@form" value="Все"
										action="#{mainFacade.doRefresh}"
										style="#{settings.requestFilter.requestStatus == null ? 'font-weight: bold' : ''}">
										<f:setPropertyActionListener
											target="#{settings.requestFilter.requestStatus}"
											value="#{null}" />
									</p:commandLink>
								</p:column>
							</p:row>
						</p:panelGrid>

					</p:column>

					<p:column>
						<h:panelGroup class="ui-icon ui-icon-grip-dotted-vertical" />
					</p:column>

					<p:column>

						<p:panelGrid>
							<p:row>
								<p:column>
									<p:commandLink process="@this" update="@form"
										value="Приняты мной" action="#{mainFacade.doRefresh}"
										style="#{settings.requestFilter.acceptedBy == currentUser.value ? 'font-weight: bold' : ''}">
										<f:setPropertyActionListener
											target="#{settings.requestFilter.acceptedBy}"
											value="#{currentUser.value}" />
									</p:commandLink>
								</p:column>
								<p:column>
									<p:commandLink process="@this" update="@form" value="Любые"
										action="#{mainFacade.doRefresh}"
										style="#{settings.requestFilter.acceptedBy == null ? 'font-weight: bold' : ''}">
										<f:setPropertyActionListener
											target="#{settings.requestFilter.acceptedBy}" value="#{null}" />
									</p:commandLink>
								</p:column>
							</p:row>
						</p:panelGrid>
					</p:column>

					<p:column>
						<h:panelGroup class="ui-icon ui-icon-grip-dotted-vertical" />
					</p:column>

					<p:column>

						<p:panelGrid>
							<p:row>
								<p:column>
									<p:commandLink process="@this" update="@form"
										value="Завершены мной" action="#{mainFacade.doRefresh}"
										style="#{settings.requestFilter.completedBy == currentUser.value ? 'font-weight: bold' : ''}">
										<f:setPropertyActionListener
											target="#{settings.requestFilter.completedBy}"
											value="#{currentUser.value}" />
									</p:commandLink>
								</p:column>
								<p:column>
									<p:commandLink process="@this" update="@form" value="Любые"
										action="#{mainFacade.doRefresh}"
										style="#{settings.requestFilter.completedBy == null ? 'font-weight: bold' : ''}">
										<f:setPropertyActionListener
											target="#{settings.requestFilter.completedBy}"
											value="#{null}" />
									</p:commandLink>
								</p:column>
							</p:row>
						</p:panelGrid>
					</p:column>

					<p:column>
						<h:panelGroup class="ui-icon ui-icon-grip-dotted-vertical" />
					</p:column>

					<p:column>
						<p:panelGrid>
							<p:row>
								<p:column>
									<p:outputLabel value="Автор:" for="createdBy" />
								</p:column>
								<p:column>
									<p:selectOneMenu id="createdBy"
										value="#{settings.requestFilter.createdBy}">
										<p:ajax process="@this" update="@form"
											listener="#{mainFacade.onFilterChanged}" />
										<f:selectItem value="#{configurationFacade.anySI}" />
										<f:selectItems value="#{si.list.few(userFacade.whoEverCreatedRequests)}" />
									</p:selectOneMenu>
								</p:column>
							</p:row>
						</p:panelGrid>
					</p:column>

				</p:row>
			</p:panelGrid>


			<p:panel header="Отбор">

				<p:panelGrid>
					<p:row>
						<p:column>
							<p:outputLabel value="Стадия:" for="progressStatus" />
						</p:column>
						<p:column>
							<p:selectOneMenu id="progressStatus"
								value="#{settings.requestFilter.progressStatus}">
								<p:ajax process="@this" update="@form"
									listener="#{mainFacade.onFilterChanged}" />
								<f:selectItem value="#{configurationFacade.anySI}" />
								<f:selectItems value="#{si.array.regular(ProgressStatus.all)}" />
							</p:selectOneMenu>
						</p:column>
						<p:column>
							<p:outputLabel value="Номер заявки:" for="id" />
						</p:column>
						<p:column>
							<p:inputNumber id="id" value="#{settings.requestFilter.id}"
								decimalPlaces="0" minValue="0" size="5">
								<p:ajax event="keyup" delay="700" process="@this" update="@form"
									listener="#{mainFacade.onFilterChanged}" />
							</p:inputNumber>
						</p:column>
						<p:column>
							<p:outputLabel value="Имя заявителя:" for="requesterNameMask" />
						</p:column>
						<p:column>
							<p:inputText id="requesterNameMask"
								value="#{settings.requestFilter.requesterNameMask}">
								<p:ajax event="keyup" delay="700" process="@this" update="@form"
									listener="#{mainFacade.onFilterChanged}" />
							</p:inputText>
						</p:column>
						<p:column>
							<p:outputLabel value="ИИН заявителя:" for="requesterIdNumberMask" />
						</p:column>
						<p:column>
							<p:inputText id="requesterIdNumberMask"
								value="#{settings.requestFilter.requesterIdNumberMask}">
								<p:ajax event="keyup" delay="700" process="@this" update="@form"
									listener="#{mainFacade.onFilterChanged}" />
							</p:inputText>
						</p:column>
					</p:row>
				</p:panelGrid>

			</p:panel>

			<ui:include src="filter.advanced.include.xhtml" />

			<p:panelGrid>
				<p:row>
					<p:column>
						<p:commandLink process="@this" update="content"
							value="еще &gt;&gt;" rendered="#{not settings.advanced}">
							<f:setPropertyActionListener target="#{settings.advanced}"
								value="#{true}" />
						</p:commandLink>
						<p:commandLink process="@this" update="content"
							value="&lt;&lt; проще" rendered="#{settings.advanced}">
							<f:setPropertyActionListener target="#{settings.advanced}"
								value="#{false}" />
						</p:commandLink>
					</p:column>
					<p:column>
						<p:commandLink value="очистить критерии поиска"
							action="#{mainFacade.doResetFilter}" process="@this"
							update="@form" />
					</p:column>
				</p:row>
			</p:panelGrid>

		</h:panelGroup>
		<!-- << wrapper -->


	</f:subview>

</ui:composition>
