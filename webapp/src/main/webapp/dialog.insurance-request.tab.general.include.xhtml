<?xml version="1.0" encoding="UTF-8" ?>
<ui:composition xmlns="http://www.w3.org/1999/xhtml"
	xmlns:h="http://xmlns.jcp.org/jsf/html"
	xmlns:ui="http://xmlns.jcp.org/jsf/facelets"
	xmlns:c="http://xmlns.jcp.org/jsp/jstl/core"
	xmlns:p="http://primefaces.org/ui"
	xmlns:crm="http://xmlns.jcp.org/jsf/composite/crm">

	<p:tab title="Общие сведения">

		<p:panel>
			<p:panelGrid>

				<crm:outputRow label="Статус заявки">
					<h:outputText
						value="#{requestStatusService.displayNameShort(ir.status)}" />
				</crm:outputRow>

				<crm:outputRow label="Стадия обработки заявки">
					<h:outputText
						value="#{progressStatusService.displayNameShort(ir.progressStatus)}" />
				</crm:outputRow>

				<crm:outputRow rendered="#{ir.progressStatus eq 'FINISHED'}"
					label="Результат">
					<c:choose>
						<c:when test="#{ir.transactionStatus eq 'NOT_COMPLETED'}">
							<h:panelGroup styleClass="request-icon icon-fail ">
								<i class="fa fa-ban " aria-hidden="true" />
							</h:panelGroup>
						</c:when>
						<c:when test="#{ir.transactionStatus eq 'COMPLETED'}">
							<h:panelGroup styleClass="request-icon icon-success ">
								<i class="fa fa-check " aria-hidden="true" />
							</h:panelGroup>
						</c:when>
					</c:choose>
					<h:outputText
						value="#{transactionStatusService.displayNameShort(ir.transactionStatus)}" />
				</crm:outputRow>

				<crm:outputRow
					rendered="#{ir.progressStatus eq 'FINISHED' and ir.transactionStatus eq 'NOT_COMPLETED'}"
					label="Причина">
					<h:outputText
						value="#{transactionProblemService.displayNameShort(ir.transactionProblem)}" />
				</crm:outputRow>

			</p:panelGrid>
		</p:panel>

		<p:panel>
			<p:panelGrid>

				<crm:outputRow label="Заявка поступила">
					<crm:outputDatetime value="#{ir.created}" />
				</crm:outputRow>

				<crm:outputRow rendered="#{not empty ir.accepted}"
					label="Принята в обработку">
					<crm:outputDatetime value="#{ir.accepted}" />
					<h:outputText rendered="#{not empty ir.acceptedBy}"
						value="&amp;nbsp;(#{ir.acceptedBy.name})" escape="false" />
				</crm:outputRow>

				<crm:outputRow rendered="#{not empty ir.completed}"
					label="Обработка завершена">
					<crm:outputDatetime value="#{ir.completed}" />
					<h:outputText rendered="#{not empty ir.completedBy}"
						value="&amp;nbsp;(#{ir.completedBy.name})" escape="false" />
				</crm:outputRow>

				<crm:outputRow rendered="#{not empty ir.closed}"
					label="Заявка закрыта">
					<crm:outputDatetime value="#{ir.closed}" />
					<h:outputText rendered="#{not empty ir.closedBy}"
						value="&amp;nbsp;(#{ir.closedBy.name})" escape="false" />
				</crm:outputRow>

			</p:panelGrid>
		</p:panel>

	</p:tab>

</ui:composition>
